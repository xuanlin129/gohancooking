import{p as H,aO as Y,g as K,u as Q,c as e,a as z,aP as J,aQ as Z,av as ee,aR as te,I as F,aS as ae,D as S,az as le,aT as se,aU as L,O as A,aV as oe,aW as ne,z as ue,A as re,E as _,_ as q,F as M,G as c,K as y,L as a,am as de,ai as j,H as E,R as W,N,aM as X,S as o,X as P,an as O,s as ie,V as m,W as I,aX as ce,P as pe}from"./index-b1644f5a.js";import{V as me}from"./VContainer-d36cbcd5.js";import{a as x,V as R}from"./VRow-97107065.js";/* empty css              */const ve=H({...Y({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),fe=K()({name:"VRadio",props:ve(),setup(s,v){let{slots:V}=v;return Q(()=>e(J,z(s,{class:["v-radio",s.class],style:s.style,type:"radio"}),V)),{}}});const _e=H({height:{type:[Number,String],default:"auto"},...Z(),...ee(te(),["multiple"]),trueIcon:{type:F,default:"$radioOn"},falseIcon:{type:F,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),ye=K()({name:"VRadioGroup",inheritAttrs:!1,props:_e(),emits:{"update:modelValue":s=>!0},setup(s,v){let{attrs:V,slots:u}=v;const p=ae(),f=S(()=>s.id||`radio-group-${p}`),d=le(s,"modelValue");return Q(()=>{const[b,U]=se(V),[$,T]=L.filterProps(s),[B,r]=J.filterProps(s),h=u.label?u.label({label:s.label,props:{for:f.value}}):s.label;return e(L,z({class:["v-radio-group",s.class],style:s.style},b,$,{modelValue:d.value,"onUpdate:modelValue":g=>d.value=g,id:f.value}),{...u,default:g=>{let{id:k,messagesId:G,isDisabled:C,isReadonly:n}=g;return e(A,null,[h&&e(oe,{id:k.value},{default:()=>[h]}),e(ne,z(B,{id:k.value,"aria-describedby":G.value,defaultsTarget:"VRadio",trueIcon:s.trueIcon,falseIcon:s.falseIcon,type:s.type,disabled:C.value,readonly:n.value,"aria-labelledby":h?k.value:void 0,multiple:!1},U,{modelValue:d.value,"onUpdate:modelValue":l=>d.value=l}),u)])}})}),{}}}),xe=o("h1",{class:"text-center h1-title mb-1"},"購物車",-1),Ve=o("div",{class:"h1-border"},null,-1),be={class:"text-left"},he={class:"d-flex align-center mt-auto ms-auto"},ge={class:"d-flex align-center",style:{border:"1px solid #333",padding:"5px","border-radius":"0.5rem"}},ke={class:"mx-3"},Ce=o("span",{class:"mx-2"},"x",-1),we=o("span",{style:{"font-size":"18px"}},"沒有商品",-1),Ie={class:"my-2",style:{"font-size":"18px","font-weight":"bolder"}},Pe=o("h4",{style:{"text-align":"left"},class:"mb-3"},"收件人資訊",-1),Re=o("h4",{style:{"text-align":"left"},class:"mb-3"},"取貨方式",-1),Se={class:"d-flex flex-column align-center",style:{padding:"120px 0"}},Ue=o("h1",null,"感謝您的購買",-1),$e=o("h6",null,"已收到您的訂單，請您檢視訂單，確認訂單狀態",-1),Be={class:"mt-5 d-flex justify-space-between",style:{width:"200px"}},ze={__name:"CartView",setup(s){const v=ue(),V=re(),u=_(1),p=_(""),f=_(""),d=_(""),b=_(""),U=_([{title:"店內自取",value:"one"},{title:"寄送",value:"two"}]),$=["購物車","填寫資料","完成訂購"],T=()=>{u.value-=1},B=()=>{u.value+=1},r=_([]),h=S(()=>r.value.reduce((n,l)=>n+l.quantity*l.product.price,0)),g=S(()=>r.value.length>0&&!r.value.some(n=>!n.product.sell)),k=S(()=>f.value===""||d.value===""||p.value===""||p.value==="two"&&b.value===""),G=async(n,l)=>{try{const i={purchaser:f.value,phone:d.value,delivery:p.value==="two"?"寄送 - "+b.value:"店內取貨"};await q.post("/orders",i),V.cart=0,u.value+=1}catch(i){v({text:i.response.data.message,showCloseButton:!1,snackbarProps:{timeout:3e3,color:"red",location:"bottom"}})}};(async()=>{try{const{data:n}=await q.get("/users/cart");r.value.push(...n.result)}catch(n){v({text:n.response.data.message,showCloseButton:!1,snackbarProps:{timeout:3e3,color:"red",location:"bottom"}})}})();const C=async(n,l)=>{try{const{data:i}=await q.post("/users/cart",{product:n,quantity:l});V.cart=i.result;const w=r.value.findIndex(t=>t.product._id===n);r.value[w].quantity+=l,r.value[w].quantity<=0&&r.value.splice(w,1)}catch(i){v({text:i.response.data.message,showCloseButton:!1,snackbarProps:{timeout:3e3,color:"red",location:"bottom"}})}};return(n,l)=>{const i=M("v-stepper-actions"),w=M("v-stepper");return c(),y(me,null,{default:a(()=>[e(R,null,{default:a(()=>[e(x,{cols:"12",style:{margin:"20px 0"}},{default:a(()=>[xe,Ve]),_:1}),e(x,{cols:"12"},{default:a(()=>[e(w,{"alt-labels":"",items:$,modelValue:u.value,"onUpdate:modelValue":l[4]||(l[4]=t=>u.value=t),"hide-actions":"",onTouchstart:l[5]||(l[5]=de(()=>{},["prevent"]))},{"item.1":a(()=>[e(j,{flat:"",title:"訂單明細",class:"text-center"},{default:a(()=>[(c(!0),E(A,null,W(r.value,t=>(c(),y(R,{key:t._id,class:ce([{"bg-opgray":!t.product.sell},"mx-auto my-2"]),style:{width:"99%",padding:"15px 0","box-shadow":"0 0 3px #ccc"}},{default:a(()=>[e(x,{cols:"4",sm:"2"},{default:a(()=>[e(pe,{class:"mx-auto",src:t.product.image,cover:"",width:100,"aspect-ratio":"1"},null,8,["src"])]),_:2},1024),e(x,{cols:"8",sm:"10",class:"d-flex flex-column",style:{position:"relative"}},{default:a(()=>[o("h4",be,P(t.product.name),1),o("div",he,[o("div",ge,[e(m,{variant:"text",icon:"mdi-minus",onClick:D=>C(t.product._id,-1),disabled:t.quantity===1,style:{width:"24px",height:"24px"}},null,8,["onClick","disabled"]),o("span",ke,P(t.quantity),1),e(m,{variant:"text",icon:"mdi-plus",onClick:D=>C(t.product._id,1),style:{width:"24px",height:"24px"}},null,8,["onClick"])]),Ce,o("span",null," NT$ "+P(t.product.price),1)]),e(m,{style:{position:"absolute",right:"0",top:"0"},color:"#ccc",variant:"text",icon:"mdi-delete",onClick:D=>C(t.product._id,t.quantity*-1)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["class"]))),128)),r.value.length===0?(c(),y(R,{key:0,style:{height:"150px"}},{default:a(()=>[e(x,{cols:"12",class:"text-center d-flex justify-center align-center"},{default:a(()=>[we]),_:1})]),_:1})):N("",!0),e(X),o("p",Ie,"總金額： "+P(h.value)+" 元",1)]),_:1})]),"item.2":a(()=>[e(j,{flat:"",title:"填寫資料",class:"text-center"},{default:a(()=>[e(R,{class:"mt-5"},{default:a(()=>[e(x,{cols:"12",md:"6"},{default:a(()=>[Pe,e(O,{modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=t=>f.value=t),variant:"outlined",label:"收件人"},null,8,["modelValue"]),e(O,{modelValue:d.value,"onUpdate:modelValue":l[1]||(l[1]=t=>d.value=t),variant:"outlined",label:"聯絡電話"},null,8,["modelValue"])]),_:1}),e(X,{vertical:""}),e(x,{cols:"12",md:"6"},{default:a(()=>[Re,e(ye,{modelValue:p.value,"onUpdate:modelValue":l[3]||(l[3]=t=>p.value=t)},{default:a(()=>[(c(!0),E(A,null,W(U.value,t=>(c(),y(fe,{key:t,label:t.title,value:t.value},null,8,["label","value"]))),128)),e(O,{label:"地址",variant:"outlined",disabled:p.value==="one",modelValue:b.value,"onUpdate:modelValue":l[2]||(l[2]=t=>b.value=t)},null,8,["disabled","modelValue"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),"item.3":a(()=>[o("div",Se,[e(ie,{icon:"mdi-check-circle-outline",style:{"font-size":"150px"},color:"#514742"}),Ue,$e,o("div",Be,[e(m,{to:"/",variant:"text",class:"btn-primary"},{default:a(()=>[I("返回首頁")]),_:1}),e(m,{to:"/account",variant:"text",class:"btn-primary-outline"},{default:a(()=>[I("查詢訂單")]),_:1})])])]),default:a(()=>[e(i,{class:"d-flex",style:{padding:"0 24px 16px"}},{default:a(()=>[u.value===2?(c(),y(m,{key:0,class:"me-auto",onClick:T},{default:a(()=>[I("上一步")]),_:1})):N("",!0),u.value===1?(c(),y(m,{key:1,class:"ms-auto btn-primary",onClick:B,disabled:r.value.length===0},{default:a(()=>[I("下一步")]),_:1},8,["disabled"])):u.value!==3?(c(),y(m,{key:2,class:"ms-auto btn-primary",onClick:G,disabled:!g.value||k.value},{default:a(()=>[I("送出訂單")]),_:1},8,["disabled"])):N("",!0)]),_:1})]),_:2},1032,["modelValue"])]),_:1})]),_:1})]),_:1})}}};export{ze as default};
