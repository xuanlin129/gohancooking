import{p as K,aN as J,g as M,u as Q,c as e,a as N,aO as X,aP as Y,au as Z,aQ as ee,I as L,aR as te,D as O,ay as ae,aS as le,aT as T,O as A,aU as se,aV as oe,z as ne,A as ue,E as v,_ as B,F as z,G as c,K as I,L as l,ah as j,aF as re,S as a,H as w,R as E,N as G,aL as W,X as P,am as q,s as de,V as p,W as y,aW as ce,P as ie}from"./index-917455ea.js";import{V as pe}from"./VContainer-e551f667.js";import{a as R,V as H}from"./VRow-e0d1fdb1.js";/* empty css              */const me=K({...J({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),ve=M()({name:"VRadio",props:me(),setup(o,m){let{slots:f}=m;return Q(()=>e(X,N(o,{class:["v-radio",o.class],style:o.style,type:"radio"}),f)),{}}});const fe=K({height:{type:[Number,String],default:"auto"},...Y(),...Z(ee(),["multiple"]),trueIcon:{type:L,default:"$radioOn"},falseIcon:{type:L,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),_e=M()({name:"VRadioGroup",inheritAttrs:!1,props:fe(),emits:{"update:modelValue":o=>!0},setup(o,m){let{attrs:f,slots:u}=m;const _=te(),V=O(()=>o.id||`radio-group-${_}`),i=ae(o,"modelValue");return Q(()=>{const[b,S]=le(f),[U,D]=T.filterProps(o),[$,r]=X.filterProps(o),h=u.label?u.label({label:o.label,props:{for:V.value}}):o.label;return e(T,N({class:["v-radio-group",o.class],style:o.style},b,U,{modelValue:i.value,"onUpdate:modelValue":x=>i.value=x,id:V.value}),{...u,default:x=>{let{id:g,messagesId:k,isDisabled:n,isReadonly:s}=x;return e(A,null,[h&&e(se,{id:g.value},{default:()=>[h]}),e(oe,N($,{id:g.value,"aria-describedby":k.value,defaultsTarget:"VRadio",trueIcon:o.trueIcon,falseIcon:o.falseIcon,type:o.type,disabled:n.value,readonly:s.value,"aria-labelledby":h?g.value:void 0,multiple:!1},S,{modelValue:i.value,"onUpdate:modelValue":d=>i.value=d}),u)])}})}),{}}}),Ve=a("h1",{class:"text-center h1-title mb-1"},"購物車",-1),ye=a("div",{class:"h1-border"},null,-1),be=a("thead",null,[a("tr",null,[a("th",{class:"text-center"},"圖片"),a("th",{class:"text-center"},"名稱"),a("th",{class:"text-center"},"價格"),a("th",{class:"text-center"},"數量"),a("th",{class:"text-center"},"小計"),a("th",{class:"text-center"},"操作")])],-1),he={class:"d-flex align-center justify-center"},xe={key:0},ge=a("td",{colspan:"6",class:"text-center"},"沒有商品",-1),ke=[ge],Ce={class:"my-2",style:{"font-size":"18px","font-weight":"bolder"}},Ie=a("h4",{style:{"text-align":"left"},class:"mb-3"},"收件人資訊",-1),Pe=a("h4",{style:{"text-align":"left"},class:"mb-3"},"取貨方式",-1),we={class:"d-flex flex-column align-center",style:{padding:"120px 0"}},Re=a("h1",null,"感謝您的購買",-1),Se=a("h6",null,"已收到您的訂單，請您檢視訂單，確認訂單狀態",-1),Ue={class:"mt-5 d-flex justify-space-between",style:{width:"200px"}},Ne={__name:"CartView",setup(o){const m=ne(),f=ue(),u=v(1),_=v(""),V=v(""),i=v(""),b=v(""),S=v([{title:"店內自取",value:"one"},{title:"寄送",value:"two"}]),U=["購物車","填寫資料","完成訂購"],D=()=>{u.value-=1},$=()=>{u.value+=1},r=v([]),h=O(()=>r.value.reduce((n,s)=>n+s.quantity*s.product.price,0)),x=O(()=>r.value.length>0&&!r.value.some(n=>!n.product.sell)),g=async(n,s)=>{try{const d={purchaser:V.value,phone:i.value,delivery:_.value==="two"?"寄送 - "+b.value:"店內取貨"};await B.post("/orders",d),f.cart=0,u.value+=1}catch(d){m({text:d.response.data.message,showCloseButton:!1,snackbarProps:{timeout:3e3,color:"red",location:"bottom"}})}};(async()=>{try{const{data:n}=await B.get("/users/cart");r.value.push(...n.result)}catch(n){m({text:n.response.data.message,showCloseButton:!1,snackbarProps:{timeout:3e3,color:"red",location:"bottom"}})}})();const k=async(n,s)=>{try{const{data:d}=await B.post("/users/cart",{product:n,quantity:s});f.cart=d.result;const C=r.value.findIndex(t=>t.product._id===n);r.value[C].quantity+=s,r.value[C].quantity<=0&&r.value.splice(C,1)}catch(d){m({text:d.response.data.message,showCloseButton:!1,snackbarProps:{timeout:3e3,color:"red",location:"bottom"}})}};return(n,s)=>{const d=z("v-stepper-actions"),C=z("v-stepper");return c(),I(pe,null,{default:l(()=>[e(H,null,{default:l(()=>[e(R,{cols:"12",style:{margin:"20px 0"}},{default:l(()=>[Ve,ye]),_:1}),e(R,{cols:"12"},{default:l(()=>[e(C,{"alt-labels":"",items:U,modelValue:u.value,"onUpdate:modelValue":s[4]||(s[4]=t=>u.value=t),"hide-actions":""},{"item.1":l(()=>[e(j,{flat:"",title:"訂單明細",class:"text-center"},{default:l(()=>[e(re,{class:"tableLayout"},{default:l(()=>[be,a("tbody",null,[(c(!0),w(A,null,E(r.value,t=>(c(),w("tr",{key:t._id,class:ce({"bg-opgray":!t.product.sell})},[a("td",null,[e(ie,{class:"mx-auto",src:t.product.image,cover:"",width:200,"aspect-ratio":"1"},null,8,["src"])]),a("td",null,P(t.product.name),1),a("td",null,P(t.product.price),1),a("td",null,[a("div",he,[e(p,{variant:"text",icon:"mdi-minus",onClick:F=>k(t.product._id,-1)},null,8,["onClick"]),y(" "+P(t.quantity)+" ",1),e(p,{variant:"text",icon:"mdi-plus",onClick:F=>k(t.product._id,1)},null,8,["onClick"])])]),a("td",null,P(t.quantity*t.product.price),1),a("td",null,[e(p,{color:"red",variant:"text",icon:"mdi-delete",onClick:F=>k(t.product._id,t.quantity*-1)},null,8,["onClick"])])],2))),128)),r.value.length===0?(c(),w("tr",xe,ke)):G("",!0)])]),_:1}),e(W),a("p",Ce,"總金額： "+P(h.value)+" 元",1)]),_:1})]),"item.2":l(()=>[e(j,{flat:"",title:"填寫資料",class:"text-center"},{default:l(()=>[e(H,{class:"mt-5"},{default:l(()=>[e(R,{cols:"12",md:"6"},{default:l(()=>[Ie,e(q,{modelValue:V.value,"onUpdate:modelValue":s[0]||(s[0]=t=>V.value=t),variant:"outlined",label:"收件人"},null,8,["modelValue"]),e(q,{modelValue:i.value,"onUpdate:modelValue":s[1]||(s[1]=t=>i.value=t),variant:"outlined",label:"聯絡電話"},null,8,["modelValue"])]),_:1}),e(W,{vertical:""}),e(R,{cols:"12",md:"6"},{default:l(()=>[Pe,e(_e,{modelValue:_.value,"onUpdate:modelValue":s[3]||(s[3]=t=>_.value=t)},{default:l(()=>[(c(!0),w(A,null,E(S.value,t=>(c(),I(ve,{key:t,label:t.title,value:t.value},null,8,["label","value"]))),128)),e(q,{label:"地址",variant:"outlined",disabled:_.value==="one",modelValue:b.value,"onUpdate:modelValue":s[2]||(s[2]=t=>b.value=t)},null,8,["disabled","modelValue"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),"item.3":l(()=>[a("div",we,[e(de,{icon:"mdi-check-circle-outline",style:{"font-size":"150px"},color:"#514742"}),Re,Se,a("div",Ue,[e(p,{to:"/",variant:"text",class:"btn-primary"},{default:l(()=>[y("返回首頁")]),_:1}),e(p,{to:"/account",variant:"text",class:"btn-primary-outline"},{default:l(()=>[y("查詢訂單")]),_:1})])])]),default:l(()=>[e(d,{class:"d-flex",style:{padding:"0 24px 16px"}},{default:l(()=>[u.value===2?(c(),I(p,{key:0,class:"me-auto",onClick:D},{default:l(()=>[y("上一步")]),_:1})):G("",!0),u.value===1?(c(),I(p,{key:1,class:"ms-auto btn-primary",onClick:$,disabled:r.value.length===0},{default:l(()=>[y("下一步")]),_:1},8,["disabled"])):u.value!==3?(c(),I(p,{key:2,class:"ms-auto btn-primary",onClick:g,disabled:!x.value},{default:l(()=>[y("送出訂單")]),_:1},8,["disabled"])):G("",!0)]),_:1})]),_:2},1032,["modelValue"])]),_:1})]),_:1})]),_:1})}}};export{Ne as default};
